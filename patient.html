
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Patient Profile</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="css/style.css" />
  <!-- Firebase SDK v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="js/firebase.js"></script>

</head>
<body class="container my-4">
  <h2>New Patient Profile</h2>

  <form id="patientForm" class="mb-3">
    <div class="mb-2">
      <label>Name</label>
      <input type="text" class="form-control" name="name" required />
    </div>
    <div class="mb-2">
      <label>Patient ID</label>
      <input type="text" class="form-control" name="id" required />
    </div>
    <div class="mb-2">
      <label>Age</label>
      <input type="number" class="form-control" name="age" />
    </div>
    <div class="mb-2">
      <label>Parity</label>
      <input type="number" class="form-control" name="parity" />
    </div>
    <div class="mb-2">
      <label>Gestational Age (weeks)</label>
      <input type="number" class="form-control" name="gestation" />
    </div>

    <button type="submit" class="btn btn-primary mt-2">Save Patient</button>
  </form>

  <div id="message"></div>

  <!-- Firebase scripts (already included in your file) -->
  <script>
    const form = document.getElementById("patientForm");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const data = {
        name: formData.get("name"),
        id: formData.get("id"),
        age: parseInt(formData.get("age")),
        parity: parseInt(formData.get("parity")),
        gestation: parseInt(formData.get("gestation")),
        createdAt: new Date().toISOString()
      };

      try {
        await db.collection("patients").doc(data.id).set(data);
        document.getElementById("message").innerHTML = `
          <div class="alert alert-success mt-3">✅ Patient saved. Ready to record observations.</div>
          <a href="record.html?patient=${data.id}" class="btn btn-success mt-2">Record Observations</a>
        `;
        form.reset();
      } catch (err) {
        document.getElementById("message").innerHTML = `
          <div class="alert alert-danger">❌ Error: ${err.message}</div>
        `;
      }
    });
  </script>
</body>

</body>
</html>
