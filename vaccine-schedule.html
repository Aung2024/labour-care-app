<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Vaccine Schedule - Maternal & Child Health Care System</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="js/firebase.js"></script>
  <style>
    :root {
      --primary-color: #10b981;
      --secondary-color: #059669;
      --warning-color: #f59e0b;
      --info-color: #3b82f6;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      min-height: 100vh;
      padding-bottom: 2rem;
    }

    .header-section {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 1.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    .baby-info-card {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      border-left: 4px solid var(--primary-color);
    }

    .schedule-card {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .schedule-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      font-size: 0.9rem;
    }

    .schedule-table th,
    .schedule-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }

    .schedule-table th {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      font-weight: 600;
      text-align: center;
    }

    .schedule-table tr:hover {
      background: #f9fafb;
    }

    .age-badge {
      display: inline-block;
      background: var(--info-color);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.85rem;
    }

    .vaccine-item {
      margin: 4px 0;
      padding: 6px 8px;
      background: #f3f4f6;
      border-radius: 6px;
      font-size: 0.85rem;
    }

    .vaccine-item.due {
      background: #fef3c7;
      border-left: 3px solid var(--warning-color);
      font-weight: 600;
    }

    .vaccine-item.completed {
      background: #d1fae5;
      border-left: 3px solid var(--primary-color);
    }

    .vaccine-item.pending {
      background: #fee2e2;
      border-left: 3px solid #ef4444;
    }

    .disease-list {
      font-size: 0.85rem;
      color: #6b7280;
      line-height: 1.6;
    }

    .section-title {
      color: var(--primary-color);
      font-weight: 700;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .loading {
      text-align: center;
      padding: 3rem;
      color: #6b7280;
    }

    @media (max-width: 768px) {
      .schedule-table {
        font-size: 0.75rem;
      }

      .schedule-table th,
      .schedule-table td {
        padding: 8px 4px;
      }

      .vaccine-item {
        font-size: 0.75rem;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header-section">
    <div class="container">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h2 class="mb-0">
            <i class="fas fa-syringe me-2"></i>
            <span class="lang-text" data-en="Vaccine Schedule" data-mm="á€€á€¬á€€á€½á€šá€ºá€†á€±á€¸á€‘á€­á€¯á€¸ á€¡á€…á€®á€¡á€…á€‰á€º">Vaccine Schedule</span>
          </h2>
          <p class="mb-0 mt-1 opacity-75 lang-text" data-en="Routine Immunization Schedule - Myanmar" data-mm="á€•á€¯á€¶á€™á€¾á€”á€ºá€€á€¬á€€á€½á€šá€ºá€†á€±á€¸á€‘á€­á€¯á€¸áŠ á€†á€±á€¸á€á€­á€¯á€€á€ºá€á€¼á€„á€ºá€¸ á€¡á€…á€®á€¡á€…á€‰á€º - á€™á€¼á€”á€ºá€™á€¬">Routine Immunization Schedule - Myanmar</p>
        </div>
        <button class="btn btn-light" onclick="goBack()">
          <i class="fas fa-arrow-left me-2"></i>
          <span class="lang-text" data-en="Back" data-mm="á€”á€±á€¬á€€á€ºá€žá€­á€¯á€·">Back</span>
        </button>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Loading State -->
    <div id="loadingState" class="loading">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2 lang-text" data-en="Loading vaccine schedule..." data-mm="á€€á€¬á€€á€½á€šá€ºá€†á€±á€¸á€‘á€­á€¯á€¸ á€¡á€…á€®á€¡á€…á€‰á€º á€á€±á€á€¹á€á€…á€±á€¬á€„á€·á€ºá€•á€«...">Loading vaccine schedule...</p>
    </div>

    <!-- Baby Info Card -->
    <div id="babyInfoCard" class="baby-info-card" style="display: none;">
      <h5 class="section-title">
        <i class="fas fa-baby"></i>
        <span class="lang-text" data-en="Baby Information" data-mm="á€€á€œá€±á€¸ á€¡á€á€»á€€á€ºá€¡á€œá€€á€º">Baby Information</span>
      </h5>
      <div class="row">
        <div class="col-md-6">
          <p><strong class="lang-text" data-en="Baby Name:" data-mm="á€€á€œá€±á€¸á€¡á€™á€Šá€º:">Baby Name:</strong> <span id="babyName">-</span></p>
        </div>
        <div class="col-md-6">
          <p><strong class="lang-text" data-en="Birth Date:" data-mm="á€™á€½á€±á€¸á€›á€€á€ºá€…á€½á€²:">Birth Date:</strong> <span id="birthDate">-</span></p>
        </div>
        <div class="col-md-6">
          <p><strong class="lang-text" data-en="Current Age:" data-mm="á€œá€€á€ºá€›á€¾á€­ á€¡á€žá€€á€º:">Current Age:</strong> <span id="currentAge">-</span></p>
        </div>
        <div class="col-md-6">
          <p><strong class="lang-text" data-en="Gender:" data-mm="á€œá€­á€„á€º:">Gender:</strong> <span id="babyGender">-</span></p>
        </div>
      </div>
    </div>

    <!-- Vaccine Schedule Card -->
    <div id="scheduleCard" class="schedule-card" style="display: none;">
      <h5 class="section-title">
        <i class="fas fa-calendar-alt"></i>
        <span class="lang-text" data-en="Vaccination Schedule" data-mm="á€€á€¬á€€á€½á€šá€ºá€†á€±á€¸á€‘á€­á€¯á€¸ á€¡á€…á€®á€¡á€…á€‰á€º">Vaccination Schedule</span>
      </h5>
      <div class="table-responsive">
        <table class="schedule-table">
          <thead>
            <tr>
              <th style="width: 15%;" class="lang-text" data-en="Age" data-mm="á€¡á€žá€€á€º">Age</th>
              <th style="width: 40%;" class="lang-text" data-en="Vaccines" data-mm="á€€á€¬á€€á€½á€šá€ºá€†á€±á€¸á€™á€»á€¬á€¸">Vaccines</th>
              <th style="width: 45%;" class="lang-text" data-en="Diseases Protected Against" data-mm="á€€á€¬á€€á€½á€šá€ºá€•á€±á€¸á€žá€Šá€·á€ºá€›á€±á€¬á€‚á€«á€™á€»á€¬á€¸">Diseases Protected Against</th>
            </tr>
          </thead>
          <tbody id="scheduleTableBody">
            <!-- Schedule rows will be populated here -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Important Notes Card -->
    <div id="notesCard" class="schedule-card" style="display: none;">
      <h5 class="section-title">
        <i class="fas fa-info-circle"></i>
        <span class="lang-text" data-en="Important Notes" data-mm="á€¡á€›á€±á€¸á€€á€¼á€®á€¸ á€™á€¾á€á€ºá€á€»á€€á€ºá€™á€»á€¬á€¸">Important Notes</span>
      </h5>
      <div class="lang-text" data-en="Hepatitis B vaccine is administered to babies born in hospitals/clinics within 24 hours of birth." data-mm="á€†á€±á€¸á€›á€¯á€¶á€†á€±á€¸á€á€”á€ºá€¸á€á€½á€„á€º á€™á€½á€±á€¸á€–á€½á€¬á€¸á€žá€±á€¬á€€á€œá€±á€¸á€™á€»á€¬á€¸á€€á€­á€¯ á€™á€½á€±á€¸á€–á€½á€¬á€¸á€•á€¼á€®á€¸á€•á€¼á€®á€¸á€á€»á€„á€ºá€¸ á‚á„ á€”á€¬á€›á€®á€¡á€á€½á€„á€ºá€¸á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€«(á€˜á€®)á€€á€¬á€€á€½á€šá€ºá€†á€±á€¸á€‘á€­á€¯á€¸á€•á€±á€¸á€”á€±á€•á€«á€žá€Šá€ºá‹">
        <p>Hepatitis B vaccine is administered to babies born in hospitals/clinics within 24 hours of birth.</p>
      </div>
      <div class="lang-text" data-en="*If BCG vaccine cannot be administered at birth, it should be given before 2 months of age, or at 2 months of age along with other vaccines." data-mm="*á€˜á€®á€…á€®á€‚á€»á€®á€€á€¬á€€á€½á€šá€ºá€†á€±á€¸á€€á€­á€¯ á€™á€½á€±á€¸á€…á€á€½á€„á€ºá€™á€‘á€­á€¯á€¸á€”á€¾á€¶á€”á€­á€¯á€„á€ºá€•á€«á€€ á€¡á€žá€€á€º(á‚)á€œá€™á€á€­á€¯á€„á€ºá€™á€®á€á€½á€„á€ºá€œá€Šá€ºá€¸á€€á€±á€¬á€„á€ºá€¸áŠ á€¡á€žá€€á€º (á‚)á€œá€á€½á€„á€º á€¡á€á€¼á€¬á€¸á€€á€¬á€€á€½á€šá€ºá€†á€±á€¸á€™á€»á€¬á€¸á€”á€¾á€„á€·á€ºá€¡á€á€°á€œá€Šá€ºá€¸á€€á€±á€¬á€„á€ºá€¸ á€‘á€­á€¯á€¸á€”á€¾á€¶á€›á€•á€«á€™á€Šá€ºá‹">
        <p>*If BCG vaccine cannot be administered at birth, it should be given before 2 months of age, or at 2 months of age along with other vaccines.</p>
      </div>
    </div>
  </div>

  <script>
    let currentUser = null;
    let patientId = null;
    let babyBirthDate = null;
    let babyName = null;
    let babyGender = null;

    // Get patient ID from URL
    const urlParams = new URLSearchParams(window.location.search);
    patientId = urlParams.get('patient');

    // Language switching
    let currentLanguage = localStorage.getItem('appLanguage') || 'mm';

    function switchLanguage(lang) {
      currentLanguage = lang;
      localStorage.setItem('appLanguage', lang);
      
      document.querySelectorAll('.lang-text').forEach(el => {
        const text = el.dataset[lang] || el.dataset.en || el.textContent;
        el.textContent = text;
      });
    }

    // Initialize language switcher
    document.querySelectorAll('.language-btn')?.forEach(btn => {
      btn.addEventListener('click', function() {
        switchLanguage(this.dataset.lang);
      });
    });

    firebase.auth().onAuthStateChanged(function(user) {
      if (!user) {
        alert("Please log in to view vaccine schedule.");
        window.location.href = "login.html";
      } else {
        currentUser = user;
        if (patientId) {
          loadBabyData();
        } else {
          alert("No patient ID provided.");
          window.close();
        }
      }
    });

    async function loadBabyData() {
      try {
        // Load patient data
        const patientDoc = await firebase.firestore()
          .collection("patients")
          .doc(patientId)
          .get();
        
        if (!patientDoc.exists) {
          alert("Patient not found!");
          window.close();
          return;
        }

        // Load newborn care data to get baby name and birth time
        const newbornCareSnapshot = await firebase.firestore()
          .collection("patients")
          .doc(patientId)
          .collection("newborn_care")
          .limit(1)
          .get();

        if (!newbornCareSnapshot.empty) {
          const newbornData = newbornCareSnapshot.docs[0].data();
          babyName = newbornData.baby_name || 'Not recorded';
          babyGender = newbornData.gender === 'male' ? 'Male' : (newbornData.gender === 'female' ? 'Female' : 'Not recorded');
          
          if (newbornData.birth_time) {
            // Convert Firestore timestamp or date string to Date object
            if (newbornData.birth_time.toDate) {
              babyBirthDate = newbornData.birth_time.toDate();
            } else if (newbornData.birth_time.seconds) {
              babyBirthDate = new Date(newbornData.birth_time.seconds * 1000);
            } else {
              babyBirthDate = new Date(newbornData.birth_time);
            }
          }
        }

        // If no newborn care data, check immediate newborn care
        if (!babyBirthDate) {
          const immediateCareSnapshot = await firebase.firestore()
            .collection("patients")
            .doc(patientId)
            .collection("immediate_newborn_care")
            .limit(1)
            .get();

          if (!immediateCareSnapshot.empty) {
            // Try to get birth date from patient record or other sources
            const patientData = patientDoc.data();
            // Could check delivery date or other fields
          }
        }

        // Populate baby info
        document.getElementById('babyName').textContent = babyName || 'Not recorded';
        if (babyBirthDate) {
          document.getElementById('birthDate').textContent = babyBirthDate.toLocaleDateString();
          document.getElementById('currentAge').textContent = calculateAge(babyBirthDate);
        } else {
          document.getElementById('birthDate').textContent = 'Not recorded';
          document.getElementById('currentAge').textContent = 'Cannot calculate - birth date not available';
        }
        document.getElementById('babyGender').textContent = babyGender || 'Not recorded';

        // Generate vaccine schedule
        generateVaccineSchedule();

        // Hide loading, show content
        document.getElementById('loadingState').style.display = 'none';
        document.getElementById('babyInfoCard').style.display = 'block';
        document.getElementById('scheduleCard').style.display = 'block';
        document.getElementById('notesCard').style.display = 'block';

        // Set initial language
        switchLanguage(currentLanguage);

      } catch (error) {
        console.error('Error loading baby data:', error);
        alert('Error loading baby data: ' + error.message);
        document.getElementById('loadingState').innerHTML = '<p class="text-danger">Error loading data. Please try again.</p>';
      }
    }

    function calculateAge(birthDate) {
      const now = new Date();
      const diffTime = now - birthDate;
      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
      
      if (diffDays < 0) {
        return 'Invalid birth date';
      }

      const months = Math.floor(diffDays / 30);
      const years = Math.floor(months / 12);
      const remainingMonths = months % 12;
      const days = diffDays % 30;

      if (currentLanguage === 'mm') {
        if (years > 0) {
          return `${years} á€”á€¾á€…á€º ${remainingMonths} á€œ`;
        } else if (months > 0) {
          return `${months} á€œ ${days} á€›á€€á€º`;
        } else {
          return `${diffDays} á€›á€€á€º`;
        }
      } else {
        if (years > 0) {
          return `${years} year${years > 1 ? 's' : ''} ${remainingMonths} month${remainingMonths !== 1 ? 's' : ''}`;
        } else if (months > 0) {
          return `${months} month${months > 1 ? 's' : ''} ${days} day${days !== 1 ? 's' : ''}`;
        } else {
          return `${diffDays} day${diffDays !== 1 ? 's' : ''}`;
        }
      }
    }

    function generateVaccineSchedule() {
      const scheduleData = [
        {
          age: 'At Birth',
          ageMm: 'á€™á€½á€±á€¸á€•á€¼á€®á€¸á€•á€¼á€®á€¸á€á€»á€„á€ºá€¸',
          vaccines: [
            { name: 'BCG*', nameMm: 'á€˜á€®á€…á€®á€‚á€»á€®*', type: 'injection' },
            { name: 'Hepatitis B', nameMm: 'á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)', type: 'injection' }
          ],
          diseases: [
            'Severe Tuberculosis',
            'Hepatitis B',
            'á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€á€®á€˜á€®á€›á€±á€¬á€‚á€«',
            'á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€«(á€˜á€®)'
          ],
          ageInDays: 0
        },
        {
          age: '2 Months',
          ageMm: 'á‚ á€œ',
          vaccines: [
            { name: 'Polio (1st)', nameMm: 'á€•á€­á€¯á€œá€®á€šá€­á€¯ (á€•á€‘á€™)', type: 'oral' },
            { name: 'Rota (1st)', nameMm: 'á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€á€™á€ºá€¸á€•á€»á€€á€ºá€á€™á€ºá€¸á€œá€»á€¾á€±á€¬ (á€›á€­á€¯á€á€¬) (á€•á€‘á€™)', type: 'oral' },
            { name: 'PCV (1st)', nameMm: 'á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€º (á€•á€®á€…á€®á€—á€®) (á€•á€‘á€™)', type: 'injection' },
            { name: 'Pentavalent (1st)', nameMm: 'á€†á€¯á€¶á€†á€­á€¯á€·áŠ á€€á€¼á€€á€ºá€Šá€¾á€¬áŠ á€™á€±á€¸á€á€­á€¯á€„á€ºáŠ á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)áŠ á€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€¡á€™á€¼á€¾á€±á€¸á€›á€±á€¬á€„á€º (á€„á€«á€¸á€™á€»á€­á€¯á€¸á€…á€•á€ºá€€á€¬á€€á€½á€šá€ºá€†á€±á€¸) (á€•á€‘á€™)', type: 'injection' }
          ],
          diseases: [
            'Polio Paralysis, Severe Diarrhea, Severe Pneumonia, Diphtheria, Pertussis, Tetanus, Hepatitis B, Meningitis/Pneumonia',
            'á€•á€­á€¯á€œá€®á€šá€­á€¯á€¡á€€á€¼á€±á€¬á€žá€±á€›á€±á€¬á€‚á€«áŠ á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€á€™á€ºá€¸á€•á€»á€€á€ºá€á€™á€ºá€¸á€œá€»á€¾á€±á€¬á€›á€±á€¬á€‚á€«áŠ á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«áŠ á€†á€¯á€¶á€†á€­á€¯á€·á€”á€¬áŠ á€€á€¼á€€á€ºá€Šá€¾á€¬áŠ á€™á€±á€¸á€á€­á€¯á€„á€ºáŠ á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)áŠ á€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€¡á€™á€¼á€¾á€±á€¸á€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«/á€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«'
          ],
          ageInDays: 60
        },
        {
          age: '4 Months',
          ageMm: 'á„ á€œ',
          vaccines: [
            { name: 'Polio (2nd)', nameMm: 'á€•á€­á€¯á€œá€®á€šá€­á€¯ (á€’á€¯á€á€­á€š)', type: 'oral' },
            { name: 'Rota (2nd)', nameMm: 'á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€á€™á€ºá€¸á€•á€»á€€á€ºá€á€™á€ºá€¸á€œá€»á€¾á€±á€¬ (á€›á€­á€¯á€á€¬) (á€’á€¯á€á€­á€š)', type: 'oral' },
            { name: 'PCV (2nd)', nameMm: 'á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€º (á€•á€®á€…á€®á€—á€®) (á€’á€¯á€á€­á€š)', type: 'injection' },
            { name: 'Polio Injection', nameMm: 'á€•á€­á€¯á€œá€®á€šá€­á€¯á€‘á€­á€¯á€¸á€†á€±á€¸', type: 'injection' },
            { name: 'Pentavalent (2nd)', nameMm: 'á€†á€¯á€¶á€†á€­á€¯á€·áŠ á€€á€¼á€€á€ºá€Šá€¾á€¬áŠ á€™á€±á€¸á€á€­á€¯á€„á€ºáŠ á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)áŠ á€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€¡á€™á€¼á€¾á€±á€¸á€›á€±á€¬á€„á€º (á€„á€«á€¸á€™á€»á€­á€¯á€¸á€…á€•á€ºá€€á€¬á€€á€½á€šá€ºá€†á€±á€¸) (á€’á€¯á€á€­á€š)', type: 'injection' }
          ],
          diseases: [
            'Polio Paralysis, Severe Diarrhea, Severe Pneumonia, Diphtheria, Pertussis, Tetanus, Hepatitis B, Meningitis/Pneumonia',
            'á€•á€­á€¯á€œá€®á€šá€­á€¯á€¡á€€á€¼á€±á€¬á€žá€±á€›á€±á€¬á€‚á€«áŠ á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€á€™á€ºá€¸á€•á€»á€€á€ºá€á€™á€ºá€¸á€œá€»á€¾á€±á€¬á€›á€±á€¬á€‚á€«áŠ á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«áŠ á€†á€¯á€¶á€†á€­á€¯á€·á€”á€¬áŠ á€€á€¼á€€á€ºá€Šá€¾á€¬áŠ á€™á€±á€¸á€á€­á€¯á€„á€ºáŠ á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)áŠ á€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€¡á€™á€¼á€¾á€±á€¸á€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«/á€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«'
          ],
          ageInDays: 120
        },
        {
          age: '6 Months',
          ageMm: 'á† á€œ',
          vaccines: [
            { name: 'Polio (3rd)', nameMm: 'á€•á€­á€¯á€œá€®á€šá€­á€¯ (á€á€á€­á€š)', type: 'oral' },
            { name: 'PCV (3rd)', nameMm: 'á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€º (á€•á€®á€…á€®á€—á€®) (á€á€á€­á€š)', type: 'injection' },
            { name: 'Pentavalent (3rd)', nameMm: 'á€†á€¯á€¶á€†á€­á€¯á€·áŠ á€€á€¼á€€á€ºá€Šá€¾á€¬áŠ á€™á€±á€¸á€á€­á€¯á€„á€ºáŠ á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)áŠ á€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€¡á€™á€¼á€¾á€±á€¸á€›á€±á€¬á€„á€º (á€„á€«á€¸á€™á€»á€­á€¯á€¸á€…á€•á€ºá€€á€¬á€€á€½á€šá€ºá€†á€±á€¸) (á€á€á€­á€š)', type: 'injection' }
          ],
          diseases: [
            'Polio Paralysis, Severe Pneumonia, Diphtheria, Pertussis, Tetanus, Hepatitis B, Meningitis/Pneumonia',
            'á€•á€­á€¯á€œá€®á€šá€­á€¯á€¡á€€á€¼á€±á€¬á€žá€±á€›á€±á€¬á€‚á€«áŠ á€•á€¼á€„á€ºá€¸á€‘á€”á€ºá€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«áŠ á€†á€¯á€¶á€†á€­á€¯á€·á€”á€¬áŠ á€€á€¼á€€á€ºá€Šá€¾á€¬áŠ á€™á€±á€¸á€á€­á€¯á€„á€ºáŠ á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)áŠ á€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€¡á€™á€¼á€¾á€±á€¸á€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«/á€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«'
          ],
          ageInDays: 180
        },
        {
          age: '9 Months',
          ageMm: 'á‰ á€œ',
          vaccines: [
            { name: 'Measles â€“ Rubella (1st)', nameMm: 'á€á€€á€ºá€žá€€á€º â€“ á€‚á€»á€­á€¯á€€á€ºá€žá€­á€¯á€¸ (á€•á€‘á€™)', type: 'injection' },
            { name: 'Japanese Encephalitis', nameMm: 'á€‚á€»á€•á€”á€ºá€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€›á€±á€¬á€„á€º', type: 'injection' }
          ],
          diseases: [
            'Measles, Rubella, Japanese Encephalitis',
            'á€á€€á€ºá€žá€€á€ºá€›á€±á€¬á€‚á€«áŠ á€‚á€»á€­á€¯á€€á€ºá€žá€­á€¯á€¸á€›á€±á€¬á€‚á€«áŠ á€‚á€»á€•á€”á€ºá€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«'
          ],
          ageInDays: 270
        },
        {
          age: '1.5 Years',
          ageMm: 'á á€”á€¾á€…á€ºá€á€½á€²',
          vaccines: [
            { name: 'Measles â€“ Rubella (2nd)', nameMm: 'á€á€€á€ºá€žá€€á€º â€“ á€‚á€»á€­á€¯á€€á€ºá€žá€­á€¯á€¸ (á€’á€¯á€á€­á€š)', type: 'injection' },
            { name: 'Pentavalent (4th)', nameMm: 'á€†á€¯á€¶á€†á€­á€¯á€·áŠ á€€á€¼á€€á€ºá€Šá€¾á€¬áŠ á€™á€±á€¸á€á€­á€¯á€„á€ºáŠ á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)áŠ á€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€¡á€™á€¼á€¾á€±á€¸á€›á€±á€¬á€„á€º (á€„á€«á€¸á€™á€»á€­á€¯á€¸á€…á€•á€ºá€€á€¬á€€á€½á€šá€ºá€†á€±á€¸) (á€…á€á€¯á€á€¹á€‘)', type: 'injection' }
          ],
          diseases: [
            'Measles, Rubella, Diphtheria, Pertussis, Tetanus, Hepatitis B, Meningitis/Pneumonia',
            'á€á€€á€ºá€žá€€á€ºá€›á€±á€¬á€‚á€«áŠ á€‚á€»á€­á€¯á€€á€ºá€žá€­á€¯á€¸áŠ á€†á€¯á€¶á€†á€­á€¯á€·á€”á€¬áŠ á€€á€¼á€€á€ºá€Šá€¾á€¬áŠ á€™á€±á€¸á€á€­á€¯á€„á€ºáŠ á€¡á€žá€Šá€ºá€¸á€›á€±á€¬á€„á€ºá€¡á€žá€¬á€¸á€á€« (á€˜á€®)áŠ á€¦á€¸á€”á€¾á€±á€¬á€€á€ºá€¡á€™á€¼á€¾á€±á€¸á€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«/á€¡á€†á€¯á€á€ºá€›á€±á€¬á€„á€ºá€›á€±á€¬á€‚á€«'
          ],
          ageInDays: 540
        },
        {
          age: '6 Years',
          ageMm: 'á† á€”á€¾á€…á€º',
          vaccines: [
            { name: 'HPV (1st)', nameMm: 'á€¡á€­á€á€º(á€á€ºá€»)á€•á€®á€—á€® (á€•á€‘á€™)', type: 'injection' }
          ],
          diseases: [
            'Cervical Cancer',
            'á€žá€¬á€¸á€¡á€­á€™á€ºá€á€±á€«á€„á€ºá€¸á€€á€„á€ºá€†á€¬á€›á€±á€¬á€‚á€«'
          ],
          ageInDays: 2190
        },
        {
          age: '10 Years',
          ageMm: 'áá€ á€”á€¾á€…á€º',
          vaccines: [
            { name: 'HPV (2nd)', nameMm: 'á€¡á€­á€á€º(á€á€ºá€»)á€•á€®á€—á€® (á€’á€¯á€á€­á€š)', type: 'injection' }
          ],
          diseases: [
            'Cervical Cancer',
            'á€žá€¬á€¸á€¡á€­á€™á€ºá€á€±á€«á€„á€ºá€¸á€€á€„á€ºá€†á€¬á€›á€±á€¬á€‚á€«'
          ],
          ageInDays: 3650
        }
      ];

      const tbody = document.getElementById('scheduleTableBody');
      tbody.innerHTML = '';

      scheduleData.forEach(schedule => {
        const row = document.createElement('tr');
        
        // Calculate if this schedule is due, overdue, or upcoming
        let status = 'pending';
        if (babyBirthDate) {
          const now = new Date();
          const babyAgeInDays = Math.floor((now - babyBirthDate) / (1000 * 60 * 60 * 24));
          
          if (babyAgeInDays >= schedule.ageInDays) {
            status = 'due'; // Due or overdue
            row.style.backgroundColor = '#fef3c7';
          } else if (babyAgeInDays >= schedule.ageInDays - 7) {
            status = 'due'; // Upcoming within 7 days
            row.style.backgroundColor = '#fef3c7';
          }
        }

        // Age column
        const ageCell = document.createElement('td');
        const ageText = currentLanguage === 'mm' ? schedule.ageMm : schedule.age;
        ageCell.innerHTML = `<span class="age-badge">${ageText}</span>`;
        row.appendChild(ageCell);

        // Vaccines column
        const vaccinesCell = document.createElement('td');
        vaccinesCell.innerHTML = schedule.vaccines.map(vaccine => {
          const vaccineName = currentLanguage === 'mm' ? vaccine.nameMm : vaccine.name;
          const icon = vaccine.type === 'oral' ? 'ðŸ’§' : 'ðŸ’‰';
          const statusClass = status === 'due' ? 'due' : 'pending';
          return `<div class="vaccine-item ${statusClass}">${icon} ${vaccineName}</div>`;
        }).join('');
        row.appendChild(vaccinesCell);

        // Diseases column
        const diseasesCell = document.createElement('td');
        const diseasesText = currentLanguage === 'mm' ? schedule.diseases[1] : schedule.diseases[0];
        diseasesCell.innerHTML = `<div class="disease-list">${diseasesText}</div>`;
        row.appendChild(diseasesCell);

        tbody.appendChild(row);
      });
    }

    function goBack() {
      if (window.history.length > 1) {
        window.history.back();
      } else {
        window.location.href = `patient-care-hub.html?patient=${patientId}`;
      }
    }
  </script>
</body>
</html>

