<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#10b981">
  <title>Provider Consent - Maternal & Child Health Care System</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <style>
    :root {
      --primary-color: #10b981;
      --secondary-color: #059669;
      --text-primary: #1f2937;
      --text-secondary: #6b7280;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: #f0fdf4;
      min-height: 100vh;
      padding: 2rem 1rem;
    }

    .consent-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 3rem 2rem;
    }

    .consent-header {
      text-align: center;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid #e5e7eb;
    }

    .consent-header h1 {
      color: var(--primary-color);
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .consent-content {
      max-height: 60vh;
      overflow-y: auto;
      padding: 1.5rem;
      background: #f9fafb;
      border-radius: 8px;
      margin-bottom: 2rem;
      line-height: 1.8;
    }

    .consent-content h3 {
      color: var(--primary-color);
      font-size: 1.3rem;
      margin-top: 1.5rem;
      margin-bottom: 0.75rem;
    }

    .consent-content ul {
      margin-left: 1.5rem;
      margin-bottom: 1rem;
    }

    .consent-content li {
      margin-bottom: 0.5rem;
    }

    .consent-actions {
      text-align: center;
      padding-top: 1.5rem;
      border-top: 1px solid #e5e7eb;
    }

    .btn-consent {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border: none;
      padding: 1rem 3rem;
      border-radius: 12px;
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s;
      margin: 0.5rem;
    }

    .btn-consent:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
    }

    .btn-consent:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-view-full {
      background: transparent;
      color: var(--primary-color);
      border: 2px solid var(--primary-color);
      padding: 0.75rem 2rem;
      border-radius: 8px;
      font-weight: 500;
      text-decoration: none;
      display: inline-block;
      margin-top: 1rem;
      transition: all 0.3s;
    }

    .btn-view-full:hover {
      background: var(--primary-color);
      color: white;
    }

    .language-switcher {
      text-align: center;
      margin-bottom: 1rem;
    }

    .language-btn {
      background: white;
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
      padding: 0.5rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      margin: 0 0.5rem;
      transition: all 0.2s;
    }

    .language-btn.active {
      background: var(--primary-color);
      color: white;
    }

    @media (max-width: 768px) {
      .consent-container {
        padding: 2rem 1.5rem;
      }

      .consent-content {
        max-height: 50vh;
      }
    }
  </style>
</head>
<body>
  <div class="consent-container">
    <div class="language-switcher">
      <button class="language-btn active" data-lang="en" onclick="switchLanguage('en')">
        <span>ðŸ‡¬ðŸ‡§</span> English
      </button>
      <button class="language-btn" data-lang="mm" onclick="switchLanguage('mm')">
        <span>ðŸ‡²ðŸ‡²</span> á€™á€¼á€”á€ºá€™á€¬
      </button>
    </div>

    <div class="consent-header">
      <h1>
        <span class="lang-text" data-en="Service Provider Consent" data-mm="á€á€”á€ºá€†á€±á€¬á€„á€ºá€™á€¾á€¯ á€•á€±á€¸á€žá€° á€á€½á€„á€·á€ºá€•á€¼á€¯á€á€»á€€á€º">Service Provider Consent</span>
      </h1>
      <p style="color: var(--text-secondary);">
        <span class="lang-text" data-en="Please read and accept to continue" data-mm="á€€á€»á€±á€¸á€‡á€°á€¸á€•á€¼á€¯á á€–á€á€ºá€›á€¾á€¯á€•á€¼á€®á€¸ á€†á€€á€ºá€œá€€á€ºá€œá€¯á€•á€ºá€†á€±á€¬á€„á€ºá€›á€”á€º á€œá€€á€ºá€á€¶á€•á€«">Please read and accept to continue</span>
      </p>
    </div>

    <div class="consent-content" id="consentContent">
      <!-- Short version will be shown by default -->
      <div id="shortVersion">
        <h3>
          <span class="lang-text" data-en="Purpose of the App" data-mm="á€¡á€€á€ºá€•á€ºá á€›á€Šá€ºá€›á€½á€šá€ºá€á€»á€€á€º">Purpose of the App</span>
        </h3>
        <p>
          <span class="lang-text" data-en="This application supports safe and standardized maternal and newborn care. It helps providers record clinical information, receive decision-support alerts, and improve quality of care through the continuum of care." data-mm="á€¤á€¡á€€á€ºá€•á€ºá€žá€Šá€º á€˜á€±á€¸á€€á€„á€ºá€¸á€žá€±á€¬ á€”á€¾á€„á€·á€º á€…á€¶á€”á€¾á€¯á€”á€ºá€¸á€žá€á€ºá€™á€¾á€á€ºá€‘á€¬á€¸á€žá€±á€¬ á€™á€­á€á€„á€ºá€”á€¾á€„á€·á€º á€™á€½á€±á€¸á€€á€„á€ºá€¸á€…á€€á€œá€±á€¸ á€…á€±á€¬á€„á€·á€ºá€›á€¾á€±á€¬á€€á€ºá€™á€¾á€¯á€€á€­á€¯ á€•á€¶á€·á€•á€­á€¯á€¸á€•á€«á€žá€Šá€ºá‹ áŽá€„á€ºá€¸á€žá€Šá€º á€…á€±á€¬á€„á€·á€ºá€›á€¾á€±á€¬á€€á€ºá€™á€¾á€¯ á€•á€±á€¸á€žá€°á€™á€»á€¬á€¸á€¡á€¬á€¸ á€†á€±á€¸á€™á€¾á€á€ºá€á€™á€ºá€¸ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸á€€á€­á€¯ á€™á€¾á€á€ºá€á€™á€ºá€¸á€á€„á€ºá€›á€”á€ºáŠ á€†á€¯á€¶á€¸á€–á€¼á€á€ºá€á€»á€€á€º-á€¡á€‘á€±á€¬á€€á€ºá€¡á€•á€¶á€· á€žá€á€­á€•á€±á€¸á€á€»á€€á€ºá€™á€»á€¬á€¸ á€›á€›á€¾á€­á€›á€”á€ºá€”á€¾á€„á€·á€º á€…á€±á€¬á€„á€·á€ºá€›á€¾á€±á€¬á€€á€ºá€™á€¾á€¯ á€†á€€á€ºá€á€­á€¯á€€á€ºá€›á€¾á€­á€™á€¾á€¯á€™á€¾á€á€…á€ºá€†á€„á€·á€º á€…á€±á€¬á€„á€·á€ºá€›á€¾á€±á€¬á€€á€ºá€™á€¾á€¯ á€¡á€›á€Šá€ºá€¡á€žá€½á€±á€¸á€€á€­á€¯ á€™á€¼á€¾á€„á€·á€ºá€á€„á€ºá€›á€”á€º á€€á€°á€Šá€®á€•á€«á€žá€Šá€ºá‹">This application supports safe and standardized maternal and newborn care. It helps providers record clinical information, receive decision-support alerts, and improve quality of care through the continuum of care.</span>
        </p>

        <h3>
          <span class="lang-text" data-en="Your Responsibilities" data-mm="á€žá€„á€·á€ºá€á€¬á€á€”á€ºá€™á€»á€¬á€¸">Your Responsibilities</span>
        </h3>
        <ul>
          <li>
            <span class="lang-text" data-en="Keep your login credentials confidential" data-mm="á€žá€„á€·á€ºá€á€„á€ºá€›á€±á€¬á€€á€ºá€á€½á€„á€·á€º á€…á€€á€¬á€¸á€á€¾á€€á€ºá€™á€»á€¬á€¸á€€á€­á€¯ á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€‘á€¬á€¸á€•á€«">Keep your login credentials confidential</span>
          </li>
          <li>
            <span class="lang-text" data-en="Enter accurate information for patient care" data-mm="á€œá€°á€”á€¬ á€…á€±á€¬á€„á€·á€ºá€›á€¾á€±á€¬á€€á€ºá€™á€¾á€¯á€¡á€á€½á€€á€º á€á€­á€€á€»á€žá€±á€¬ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸á€€á€­á€¯ á€‘á€Šá€·á€ºá€žá€½á€„á€ºá€¸á€•á€«">Enter accurate information for patient care</span>
          </li>
          <li>
            <span class="lang-text" data-en="Protect patient privacy and confidentiality at all times" data-mm="á€œá€°á€”á€¬ á€€á€­á€¯á€šá€ºá€›á€±á€¸á€œá€¯á€¶á€á€¼á€¯á€¶á€™á€¾á€¯á€”á€¾á€„á€·á€º á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€™á€¾á€¯á€€á€­á€¯ á€¡á€™á€¼á€²á€á€™á€ºá€¸ á€€á€¬á€€á€½á€šá€ºá€•á€«">Protect patient privacy and confidentiality at all times</span>
          </li>
          <li>
            <span class="lang-text" data-en="Ensure that devices used to access this app are secured" data-mm="á€¤á€¡á€€á€ºá€•á€ºá€€á€­á€¯ á€á€„á€ºá€›á€±á€¬á€€á€ºá€›á€”á€º á€¡á€žá€¯á€¶á€¸á€•á€¼á€¯á€žá€±á€¬ á€€á€­á€›á€­á€šá€¬á€™á€»á€¬á€¸á€žá€Šá€º á€œá€¯á€¶á€á€¼á€¯á€¶á€€á€¼á€±á€¬á€„á€ºá€¸ á€žá€±á€á€»á€¬á€…á€±á€•á€«">Ensure that devices used to access this app are secured</span>
          </li>
          <li>
            <span class="lang-text" data-en="Follow your facility's protocols and national policies on data handling" data-mm="á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€€á€­á€¯á€„á€ºá€á€½á€šá€ºá€™á€¾á€¯á€”á€¾á€„á€·á€ºá€•á€á€ºá€žá€€á€ºá á€žá€„á€·á€ºá€†á€±á€¸á€›á€¯á€¶á á€œá€¯á€•á€ºá€‘á€¯á€¶á€¸á€œá€¯á€•á€ºá€”á€Šá€ºá€¸á€™á€»á€¬á€¸á€”á€¾á€„á€·á€º á€¡á€™á€»á€­á€¯á€¸á€žá€¬á€¸ á€™á€°á€á€«á€’á€™á€»á€¬á€¸á€€á€­á€¯ á€œá€­á€¯á€€á€ºá€”á€¬á€•á€«">Follow your facility's protocols and national policies on data handling</span>
          </li>
        </ul>

        <h3>
          <span class="lang-text" data-en="Data Security" data-mm="á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€œá€¯á€¶á€á€¼á€¯á€¶á€™á€¾á€¯">Data Security</span>
        </h3>
        <p>
          <span class="lang-text" data-en="All data are encrypted and stored securely. Your use of the app is subject to Myanmar's Cybersecurity Law and relevant data protection principles." data-mm="á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€¡á€¬á€¸á€œá€¯á€¶á€¸á€€á€­á€¯ á€¡á€™á€¾á€”á€ºá€•á€¼á€±á€¬á€„á€ºá€¸á€œá€²á€‘á€¬á€¸á€•á€¼á€®á€¸ á€œá€¯á€¶á€á€¼á€¯á€¶á€…á€½á€¬ á€žá€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€‘á€¬á€¸á€•á€«á€žá€Šá€ºá‹ á€¡á€€á€ºá€•á€ºá€€á€­á€¯ á€¡á€žá€¯á€¶á€¸á€•á€¼á€¯á€á€¼á€„á€ºá€¸á€žá€Šá€º á€™á€¼á€”á€ºá€™á€¬á€”á€­á€¯á€„á€ºá€„á€¶á á€†á€­á€¯á€€á€ºá€˜á€¬á€œá€¯á€¶á€á€¼á€¯á€¶á€™á€¾á€¯ á€¥á€•á€’á€±á€”á€¾á€„á€·á€º á€žá€€á€ºá€†á€­á€¯á€„á€ºá€›á€¬ á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€€á€¬á€€á€½á€šá€ºá€™á€¾á€¯ á€”á€­á€šá€¬á€™á€™á€»á€¬á€¸á€”á€¾á€„á€·á€º á€…á€•á€ºá€œá€»á€‰á€ºá€¸á€•á€«á€žá€Šá€ºá‹">All data are encrypted and stored securely. Your use of the app is subject to Myanmar's Cybersecurity Law and relevant data protection principles.</span>
        </p>
      </div>

      <!-- Full version (hidden by default, shown when "View Full Policy" is clicked) -->
      <div id="fullVersion" style="display: none;">
        <p>
          <span class="lang-text" data-en="This application processes clinical information for patient care. As a registered user, you agree to handle all data in accordance with:" data-mm="á€¤á€¡á€€á€ºá€•á€ºá€žá€Šá€º á€œá€°á€”á€¬ á€…á€±á€¬á€„á€·á€ºá€›á€¾á€±á€¬á€€á€ºá€™á€¾á€¯á€¡á€á€½á€€á€º á€†á€±á€¸á€™á€¾á€á€ºá€á€™á€ºá€¸ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸á€€á€­á€¯ á€œá€¯á€•á€ºá€†á€±á€¬á€„á€ºá€•á€«á€žá€Šá€ºá‹ á€™á€¾á€á€ºá€•á€¯á€¶á€á€„á€ºá€‘á€¬á€¸á€žá€±á€¬ á€¡á€žá€¯á€¶á€¸á€•á€¼á€¯á€žá€°á€¡á€–á€¼á€…á€ºáŠ á€žá€„á€ºá€žá€Šá€º á€¡á€±á€¬á€€á€ºá€•á€«á€”á€¾á€„á€·á€ºá€¡á€Šá€® á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€¡á€¬á€¸á€œá€¯á€¶á€¸á€€á€­á€¯ á€€á€­á€¯á€„á€ºá€á€½á€šá€ºá€›á€”á€º á€žá€˜á€±á€¬á€á€°á€•á€«á€žá€Šá€º:">This application processes clinical information for patient care. As a registered user, you agree to handle all data in accordance with:</span>
        </p>
        <ul>
          <li>
            <span class="lang-text" data-en="WHO Digital Health Ethics and Data Governance principles" data-mm="WHO á€’á€…á€ºá€‚á€»á€…á€ºá€á€šá€º á€€á€»á€”á€ºá€¸á€™á€¬á€›á€±á€¸ á€€á€»á€„á€·á€ºá€á€á€ºá€”á€¾á€„á€·á€º á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€™á€¾á€¯ á€”á€­á€šá€¬á€™á€™á€»á€¬á€¸">WHO Digital Health Ethics and Data Governance principles</span>
          </li>
          <li>
            <span class="lang-text" data-en="Myanmar Cybersecurity Law No. 1/2025 (as applicable to digital platforms and critical information systems)" data-mm="á€™á€¼á€”á€ºá€™á€¬á€”á€­á€¯á€„á€ºá€„á€¶ á€†á€­á€¯á€€á€ºá€˜á€¬á€œá€¯á€¶á€á€¼á€¯á€¶á€™á€¾á€¯ á€¥á€•á€’á€± á€¡á€™á€¾á€á€º á/á‚á€á‚á… (á€’á€…á€ºá€‚á€»á€…á€ºá€á€šá€º á€•á€œá€€á€ºá€–á€±á€¬á€„á€ºá€¸á€™á€»á€¬á€¸á€”á€¾á€„á€·á€º á€¡á€›á€±á€¸á€€á€¼á€®á€¸á€žá€±á€¬ á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€…á€”á€…á€ºá€™á€»á€¬á€¸á€”á€¾á€„á€·á€º á€žá€€á€ºá€†á€­á€¯á€„á€ºá€›á€¬)">Myanmar Cybersecurity Law No. 1/2025 (as applicable to digital platforms and critical information systems)</span>
          </li>
          <li>
            <span class="lang-text" data-en="Your facility's professional confidentiality obligations" data-mm="á€žá€„á€·á€ºá€†á€±á€¸á€›á€¯á€¶á á€•á€Šá€¬á€›á€•á€º á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€™á€¾á€¯ á€á€¬á€á€”á€ºá€á€á€¹á€á€›á€¬á€¸á€™á€»á€¬á€¸">Your facility's professional confidentiality obligations</span>
          </li>
          <li>
            <span class="lang-text" data-en="Jhpiego/MOH data governance policies" data-mm="Jhpiego/MOH á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€™á€¾á€¯ á€™á€°á€á€«á€’á€™á€»á€¬á€¸">Jhpiego/MOH data governance policies</span>
          </li>
        </ul>

        <h3>
          <span class="lang-text" data-en="You Acknowledge:" data-mm="á€žá€„á€ºá€žá€Šá€º á€¡á€žá€­á€¡á€™á€¾á€á€ºá€•á€¼á€¯á€•á€«á€žá€Šá€º:">You Acknowledge:</span>
        </h3>
        <ul>
          <li>
            <span class="lang-text" data-en="Patient data is confidential and must not be disclosed except for clinical care or authorized reporting" data-mm="á€œá€°á€”á€¬ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸á€žá€Šá€º á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€–á€¼á€…á€ºá€•á€¼á€®á€¸ á€†á€±á€¸á€™á€¾á€á€ºá€á€™á€ºá€¸ á€…á€±á€¬á€„á€·á€ºá€›á€¾á€±á€¬á€€á€ºá€™á€¾á€¯ á€žá€­á€¯á€·á€™á€Ÿá€¯á€á€º á€á€½á€„á€·á€ºá€•á€¼á€¯á€‘á€¬á€¸á€žá€±á€¬ á€¡á€…á€®á€›á€„á€ºá€á€¶á€…á€¬á€¡á€•á€¼á€„á€º á€‘á€¯á€á€ºá€–á€±á€¬á€ºá€›á€™á€Šá€º á€™á€Ÿá€¯á€á€ºá€•á€«">Patient data is confidential and must not be disclosed except for clinical care or authorized reporting</span>
          </li>
          <li>
            <span class="lang-text" data-en="You are responsible for securing your device, ensuring no unauthorized person accesses the app" data-mm="á€žá€„á€ºá€žá€Šá€º á€žá€„á€·á€ºá€€á€­á€›á€­á€šá€¬á€€á€­á€¯ á€œá€¯á€¶á€á€¼á€¯á€¶á€…á€±á€›á€”á€º á€á€¬á€á€”á€ºá€›á€¾á€­á€•á€¼á€®á€¸áŠ á€á€½á€„á€·á€ºá€•á€¼á€¯á€‘á€¬á€¸á€á€¼á€„á€ºá€¸á€™á€›á€¾á€­á€žá€±á€¬ á€•á€¯á€‚á€¹á€‚á€­á€¯á€œá€ºá€á€…á€ºá€¦á€¸á€™á€»á€¾ á€¡á€€á€ºá€•á€ºá€€á€­á€¯ á€á€„á€ºá€›á€±á€¬á€€á€ºá€”á€­á€¯á€„á€ºá€á€¼á€„á€ºá€¸ á€™á€›á€¾á€­á€…á€±á€›á€”á€º á€žá€±á€á€»á€¬á€…á€±á€›á€™á€Šá€º">You are responsible for securing your device, ensuring no unauthorized person accesses the app</span>
          </li>
          <li>
            <span class="lang-text" data-en="Audit logs will record your usage for data security purposes" data-mm="á€…á€…á€ºá€†á€±á€¸á€™á€¾á€á€ºá€á€™á€ºá€¸á€™á€»á€¬á€¸á€žá€Šá€º á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€œá€¯á€¶á€á€¼á€¯á€¶á€™á€¾á€¯ á€›á€Šá€ºá€›á€½á€šá€ºá€á€»á€€á€ºá€™á€»á€¬á€¸á€¡á€á€½á€€á€º á€žá€„á€·á€ºá€¡á€žá€¯á€¶á€¸á€•á€¼á€¯á€™á€¾á€¯á€€á€­á€¯ á€™á€¾á€á€ºá€á€™á€ºá€¸á€á€„á€ºá€•á€«á€™á€Šá€º">Audit logs will record your usage for data security purposes</span>
          </li>
          <li>
            <span class="lang-text" data-en="Any suspected data breach must be reported immediately to your supervisor and system administrator" data-mm="á€™á€Šá€ºá€žá€Šá€·á€º á€žá€¶á€žá€šá€›á€¾á€­á€žá€±á€¬ á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€á€»á€­á€¯á€¸á€–á€±á€¬á€€á€ºá€™á€¾á€¯á€€á€­á€¯á€™á€†á€­á€¯ á€žá€„á€·á€ºá€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€žá€°á€”á€¾á€„á€·á€º á€…á€”á€…á€º á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€žá€°á€‘á€¶ á€á€»á€€á€ºá€á€»á€„á€ºá€¸ á€¡á€…á€®á€›á€„á€ºá€á€¶á€›á€™á€Šá€º">Any suspected data breach must be reported immediately to your supervisor and system administrator</span>
          </li>
        </ul>

        <p style="margin-top: 1.5rem; font-weight: 600;">
          <span class="lang-text" data-en="By providing consent, you confirm your responsibility for respecting and protecting patient privacy while using this system." data-mm="á€á€½á€„á€·á€ºá€•á€¼á€¯á€á€»á€€á€º á€•á€±á€¸á€á€¼á€„á€ºá€¸á€–á€¼á€„á€·á€ºáŠ á€žá€„á€ºá€žá€Šá€º á€¤á€…á€”á€…á€ºá€€á€­á€¯ á€¡á€žá€¯á€¶á€¸á€•á€¼á€¯á€”á€±á€…á€‰á€º á€œá€°á€”á€¬ á€€á€­á€¯á€šá€ºá€›á€±á€¸á€œá€¯á€¶á€á€¼á€¯á€¶á€™á€¾á€¯á€€á€­á€¯ á€œá€±á€¸á€…á€¬á€¸á€€á€¬ á€€á€¬á€€á€½á€šá€ºá€›á€”á€º á€žá€„á€·á€ºá€á€¬á€á€”á€ºá€€á€­á€¯ á€¡á€á€Šá€ºá€•á€¼á€¯á€•á€«á€žá€Šá€ºá‹">By providing consent, you confirm your responsibility for respecting and protecting patient privacy while using this system.</span>
        </p>
      </div>
    </div>

    <div class="consent-actions">
      <button class="btn-consent" id="agreeBtn" onclick="acceptConsent()">
        <i class="fas fa-check-circle me-2"></i>
        <span class="lang-text" data-en="I Agree and Accept" data-mm="á€€á€»á€½á€”á€ºá€¯á€•á€ºá€žá€Šá€º á€žá€˜á€±á€¬á€á€°á€•á€¼á€®á€¸ á€œá€€á€ºá€á€¶á€•á€«á€žá€Šá€º">I Agree and Accept</span>
      </button>
      <br>
      <a href="privacy-policy.html" target="_blank" class="btn-view-full">
        <i class="fas fa-external-link-alt me-2"></i>
        <span class="lang-text" data-en="View Full Privacy Policy" data-mm="á€•á€¼á€Šá€·á€ºá€…á€¯á€¶á€žá€±á€¬ á€€á€­á€¯á€šá€ºá€›á€±á€¸á€œá€¯á€¶á€á€¼á€¯á€¶á€™á€¾á€¯ á€™á€°á€á€«á€’á€€á€­á€¯ á€€á€¼á€Šá€·á€ºá€›á€¾á€¯á€›á€”á€º">View Full Privacy Policy</span>
      </a>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="js/firebase.js"></script>
  <script src="js/consent-manager.js"></script>

  <script>
    let currentLanguage = localStorage.getItem('appLanguage') || 'en';
    let currentUser = null;

    function switchLanguage(lang) {
      currentLanguage = lang;
      localStorage.setItem('appLanguage', lang);
      
      document.querySelectorAll('.language-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === lang);
      });
      
      document.querySelectorAll('.lang-text').forEach(el => {
        const text = el.dataset[lang] || el.dataset.en || el.textContent;
        el.textContent = text;
      });
    }

    // Check authentication
    firebase.auth().onAuthStateChanged(async function(user) {
      if (!user) {
        window.location.href = 'login.html';
        return;
      }
      
      currentUser = user;
      
      // Check if consent already given and not expired with timeout
      try {
        const consentCheck = await Promise.race([
          ConsentManager.checkProviderConsent(user.uid),
          new Promise((_, reject) => setTimeout(() => reject(new Error('Consent check timeout')), 10000))
        ]);
        
        if (consentCheck.hasConsent && !consentCheck.needsReconsent) {
          // Consent is valid, redirect to app
          window.location.href = 'index.html';
          return;
        }
      } catch (error) {
        console.warn('Error checking consent status, showing consent form anyway:', error);
        // Continue to show consent form if check fails
      }
      
      // Initialize language
      switchLanguage(currentLanguage);
    });

    async function acceptConsent() {
      if (!currentUser) {
        alert('Please log in first');
        window.location.href = 'login.html';
        return;
      }

      const agreeBtn = document.getElementById('agreeBtn');
      const originalText = agreeBtn.innerHTML;
      agreeBtn.disabled = true;
      agreeBtn.innerHTML = '<div class="spinner-border spinner-border-sm me-2"></div> <span class="lang-text" data-en="Processing..." data-mm="á€œá€¯á€•á€ºá€†á€±á€¬á€„á€ºá€”á€±á€žá€Šá€º...">Processing...</span>';

      // Add overall timeout to prevent getting stuck
      const overallTimeout = setTimeout(() => {
        agreeBtn.disabled = false;
        agreeBtn.innerHTML = originalText;
        alert('Request is taking longer than expected. Please check your internet connection and try again.');
      }, 15000); // 15 second overall timeout

      try {
        // Get IP address with timeout
        let ipAddress = null;
        try {
          ipAddress = await Promise.race([
            ConsentManager.getClientIP(),
            new Promise((_, reject) => setTimeout(() => reject(new Error('IP fetch timeout')), 5000))
          ]);
        } catch (ipError) {
          console.log('Could not fetch IP, continuing without it:', ipError);
          // Continue without IP address
        }
        
        // Save consent with timeout
        const saved = await Promise.race([
          ConsentManager.saveProviderConsent(
            currentUser.uid,
            currentUser.email,
            ipAddress
          ),
          new Promise((_, reject) => setTimeout(() => reject(new Error('Save timeout')), 12000))
        ]);

        clearTimeout(overallTimeout);

        if (saved) {
          // Show success message briefly before redirect
          agreeBtn.innerHTML = '<i class="fas fa-check-circle me-2"></i> <span class="lang-text" data-en="Success! Redirecting..." data-mm="á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á€žá€Šá€º! á€œá€™á€ºá€¸á€Šá€½á€¾á€”á€ºá€”á€±á€žá€Šá€º...">Success! Redirecting...</span>';
          // Redirect to app
          setTimeout(() => {
            window.location.href = 'index.html';
          }, 500);
        } else {
          clearTimeout(overallTimeout);
          alert('Error saving consent. Please try again.');
          agreeBtn.disabled = false;
          agreeBtn.innerHTML = originalText;
        }
      } catch (error) {
        clearTimeout(overallTimeout);
        console.error('Error accepting consent:', error);
        
        // Update button text based on language
        const errorMsg = currentLanguage === 'mm' 
          ? 'á€™á€¾á€¬á€¸á€šá€½á€„á€ºá€¸á€™á€¾á€¯: ' + (error.message || 'á€™á€žá€­á€›á€žá€±á€¬ á€¡á€™á€¾á€¬á€¸')
          : 'Error: ' + (error.message || 'Unknown error');
        
        alert(errorMsg);
        agreeBtn.disabled = false;
        agreeBtn.innerHTML = originalText;
      }
    }

    // Initialize language on page load
    document.addEventListener('DOMContentLoaded', function() {
      switchLanguage(currentLanguage);
    });
  </script>
</body>
</html>

